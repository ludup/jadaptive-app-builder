<!DOCTYPE html>
<html lang="en" xmlns:jad="https://jadaptive.com/jadaptive">
<body>
<div class="col-12">
	<p class="alert alert-info"><i class="far fa-info"></i> <span jad:bundle="createAccount" jad:i18n="createAccount.summary"></span></p>
</div>
<div id="feedback" class="col-12"></div>
<div class="col-12" jad:id="objectRenderer" jad:handler="setup" jad:resourceKey="createAccount">

</div>
<div>
<script type="text/javascript">

 $(function() {
	 Wizard.initStep('setup', function(success, cancel) {
		 
		 if(!JadaptiveUtils.checkBlank([ $('#username'), $('#email'), $('#firstPassword'), $('#secondPassword')])) {
			 JadaptiveUtils.error($('#feedback'), "Please complete all fields!");
			 cancel();
			 return;
		 }
		 if($('#firstPassword').val() !== $('#secondPassword').val()) {
			 JadaptiveUtils.error($('#feedback'), "The passwords do not match!");
			 cancel();
			 return;
		 }
		 
		 $.ajax({
	           type: "POST",
	           url: $('form').attr('action'),
	           data: JadaptiveUtils.serializeForm($("form")),
	           contentType: $("form").attr('enctype'),
	           dataType: 'json',
	           success: function(data)
	           {
	           	   	if(data.success) {
	           			success();
	           	   	} else {
	           	    	JadaptiveUtils.error($('#feedback'), data.message);
	           	   	}
	           },
	           complete: function() {
					cancel();
	           }
	      });
	 });
 });
</script>
</div>

</body>
</html>